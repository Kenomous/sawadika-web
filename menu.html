<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Menu Sawadika : specialites thai, chinoises et japonaises." />
    <title>Menu | Sawadika</title>
    <link rel="icon" href="./favicon.ico" sizes="any" />
    <link rel="icon" type="image/png" href="./favicon.png" />
    <link rel="stylesheet" href="./styles.css" />
    <script src="./data.js" defer></script>
  </head>
  <body>
    <main class="page">
      <header class="topbar">
        <a class="brand" href="./index.html">
          <img src="./_assets/v11/7d430060b52ad00caf731348e0b37642ca6bf1ea.png" alt="Logo Sawadika" />
          <div class="brand-name">Sawadika</div>
        </a>
        <nav class="nav" aria-label="Navigation principale">
          <a class="active" href="./menu.html">Menu</a>
          <a href="./reservation.html">Reserver</a>
          <a href="./panier.html">Panier</a>
        </nav>
      </header>

      <h1 class="section-title">Le Menu</h1>
      <p class="section-subtitle">Des plats signatures prepares minute. Prix clairs et commandes simplifiees.</p>

      <section class="grid grid-3" id="menu-grid" aria-label="Liste des plats"></section>
    </main>

    <script>
      function getCart() {
        try {
          return JSON.parse(localStorage.getItem(window.SAWADIKA_CART_KEY) || "[]");
        } catch {
          return [];
        }
      }

      function setCart(cart) {
        localStorage.setItem(window.SAWADIKA_CART_KEY, JSON.stringify(cart));
      }

      function addToCart(itemId) {
        const cart = getCart();
        const current = cart.find((x) => x.id === itemId);
        if (current) {
          current.qty += 1;
        } else {
          cart.push({ id: itemId, qty: 1 });
        }
        setCart(cart);
        alert("Plat ajoute au panier.");
      }

      function renderMenu() {
        const root = document.getElementById("menu-grid");
        root.innerHTML = "";
        window.SAWADIKA_MENU.forEach((item) => {
          const card = document.createElement("article");
          card.className = "card";
          card.innerHTML = `
            <div class="badge">${item.category}</div>
            <h2 class="item-name">${item.name}</h2>
            <p class="item-desc">${item.desc}</p>
            <div class="item-footer">
              <span class="price">${window.priceEUR(item.price)}</span>
              <button class="btn btn-primary" type="button" data-id="${item.id}">Ajouter</button>
            </div>
          `;
          root.appendChild(card);
        });

        root.querySelectorAll("button[data-id]").forEach((btn) => {
          btn.addEventListener("click", () => addToCart(btn.getAttribute("data-id")));
        });
      }

      renderMenu();
    </script>
  </body>
</html>
